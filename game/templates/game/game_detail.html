{% extends 'game/base.html' %}
{% load staticfiles %}

{% block content %}
    {% load staticfiles %}
    <div class="container">
        <h1>{{ game.name }}</h1>
        <p>{{ game.text }}</p>
        <p>{{ user_media }}</p>
        <col>
            <h4>Disponível para:</h4>
            <ol class="breadcrumb">
            {% for platform in platforms %}
                <li class="breadcrumb-item">{{ platform.name }}</li>
            {% endfor %}
            </ol>
        </col>

    {% if game.pic1 and game.pic2 and game.pic3 %}
            <div id='myCarousel'class="carousel slide carousel-fade" 
            style="text-align:center; margin:20px;"
            data-ride="carousel">
                <div class="carousel-item active">
                    <img style="height:65%; width:65%; baackground-repeat: no-repeat;
                    background-attachment: fixed !important;
                    background-size: cover !important
                    background-position: center !important; border: solid black 2px;" 
                    src="{{ game.pic1.url }}">
                </div>
                <div class="carousel-item">
                    <img style="height:65%; width:65%; baackground-repeat: no-repeat;
                    background-attachment: fixed !important;
                    background-size: cover !important
                    background-position: center !important; border: solid black 2px;" 
                    src="{{ game.pic2.url }}">
                </div>
                <div class="carousel-item">
                    <img style="height:65%; width:65%; baackground-repeat: no-repeat;
                    background-attachment: fixed !important;
                    background-size: cover !important
                    background-position: center !important; border: solid black 2px;" 
                    src="{{ game.pic3.url }}">
                </div>
                <a class="carousel-control-prev" 
                href="#myCarousel" 
                role="button" 
                data-slide="prev">
                    <span class="carousel-control-prev-icon"
                     aria-hidden="true"></span>
                    <span class="sr-only">Previous</span>
                </a>
                <a class="carousel-control-next" 
                href="#myCarousel" 
                role="button" 
                data-slide="next">
                    <span class="carousel-control-next-icon" 
                    aria-hidden="true"></span>
                    <span class="sr-only">Next</span>
                </a>
            </div>
    {% endif %}

    {% if user.is_authenticated %}
        <div style="display:flex; margin-bottom:20px;">
        {% if game not in currently_playing %}
            <form action="{% url 'playing' game.id %}">
                <button type="submit"  
                        class="btn btn-primary"
                        style="margin-right:5px;">
                        Estou jogando
                </button>
            </form>
        {% else %}
            <form action="{% url 'delete_playing' game.id %}">
                <button type="submit"  
                        class="btn btn-primary"
                        style="margin-right:5px;">
                        Não estou mais jogando
                </button>
            </form>        
        {% endif %}
        {% if game not in wishlist %}
            <form action="{% url 'wishlist' game.id %}">
                <button type="submit" 
                        class="btn btn-primary"
                        style="margin-right:5px;">
                        Colocar na fila
                </button>
            </form>
        {% else %}
            <form action="{% url 'delete_wishlist' game.id %}">
                <button type="submit"  
                        class="btn btn-primary"
                        style="margin-right:5px;">
                        Tirar da fila
                </button>
            </form>   
        {% endif %}
        {% if game not in finished %}
            <form action="{% url 'finished' game.id %}">
                <button type="submit" 
                        class="btn btn-primary"
                        style="margin-right:5px;">
                        Terminado
                </button>
            </form>
        {% else %}
            <form action="{% url 'delete_finished' game.id %}">
                <button type="submit"  
                        class="btn btn-primary"
                        style="margin-right:5px;">
                        Tirar dos finalizados
                </button>
            </form> 
        {% endif %}
        </div>

        {% if reviewuser %}
            <p>
                <form action="{% url 'delete_review' game.id %}">
                    <button type="submit" 
                            class="btn btn-success"
                            style="margin-right:5px;">
                            Apagar análise
                    </button>
                </form>
            </p>
        {% else %}
            <p>
                <form action="{% url 'new_review' game.id %}">
                    <button type="submit" 
                            class="btn btn-success"
                            style="margin-right:5px;">
                            Criar análise
                    </button>
                </form>
            </p>
        {% endif %}
    {% endif %}

    <div class="list-group" style="margin-bottom:20px;">
        {% for review in reviews %}
        <a class="list-group-item list-group-item-action flex-column align-items-start">
            <div class="d-flex w-100 justify-content-between">
                <h5 class="mb-1">{{ review.author }}</h5>
                <small>{{ review.date }}</small>
            </div>
            <p class="mb-1">{{ review.text }}</p>
                {% if review.note < 5 %}
                    <span class="badge badge-danger badge-pill">{{ review.note }}</span>
                {% endif %}
                {% if review.note >= 5 and review.note < 7 %}
                    <span class="badge badge-warning badge-pill">{{ review.note }}</span>
                {% endif %}
                {% if review.note >= 7 %}
                    <span class="badge badge-success badge-pill">{{ review.note }}</span>
                {% endif %}
        </a>
        {% endfor %}
        </ul>
    </div>
{% endblock %}